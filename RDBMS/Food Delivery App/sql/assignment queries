1.Retrieve names and locations of restaurants with a rating of 4.5 or higher:
SELECT Name, City
FROM Restaurants
WHERE Rating >= 4.5;

2.Total number of orders placed by each customer:
SELECT Customers.FirstName, Customers.LastName, COUNT(Orders.OrderID) AS TotalOrders
FROM Customers
LEFT JOIN Orders ON Customers.CustomerID = Orders.CustomerID
GROUP BY Customers.CustomerID;

3.List all restaurants offering "Italian" cuisine in "Mumbai":
SELECT Name
FROM Restaurants
WHERE CuisineType = 'Italian' AND City = 'Mumbai';

4. Total revenue generated by each restaurant from completed orders:
SELECT Restaurants.Name, SUM(Orders.OrderAmount) AS TotalRevenue
FROM Restaurants
JOIN Orders ON Restaurants.RestaurantID = Orders.RestaurantID
WHERE Orders.OrderStatus = 'Delivered'
GROUP BY Restaurants.RestaurantID;

5. Most recent order placed by each customer:
SELECT Customers.FirstName, Customers.LastName, MAX(Orders.OrderDate) AS MostRecentOrder
FROM Customers
LEFT JOIN Orders ON Customers.CustomerID = Orders.CustomerID
GROUP BY Customers.CustomerID;


6. Customers who have not placed any orders:
SELECT FirstName, LastName
FROM Customers
WHERE CustomerID NOT IN (SELECT DISTINCT CustomerID FROM Orders);

7. Identify the most reviewed restaurants:
SELECT Restaurants.Name, COUNT(Reviews.ReviewID) AS TotalReviews
FROM Restaurants
JOIN Reviews ON Restaurants.RestaurantID = Reviews.RestaurantID
GROUP BY Restaurants.RestaurantID
ORDER BY TotalReviews DESC;

8.Find the most preferred payment method:
SELECT PaymentMethod, COUNT(PaymentID) AS TotalPayments
FROM Payments
GROUP BY PaymentMethod
ORDER BY TotalPayments DESC
LIMIT 1;

9. Top 5 restaurants by total revenue:
SELECT Restaurants.Name, SUM(Orders.OrderAmount) AS TotalRevenue
FROM Restaurants
JOIN Orders ON Restaurants.RestaurantID = Orders.RestaurantID
WHERE Orders.OrderStatus = 'Delivered'
GROUP BY Restaurants.RestaurantID
ORDER BY TotalRevenue DESC
LIMIT 5;

10. Details of all cancelled orders:
SELECT Orders.OrderID, Customers.FirstName, Customers.LastName, Restaurants.Name AS RestaurantName, Orders.OrderAmount
FROM Orders
JOIN Customers ON Orders.CustomerID = Customers.CustomerID
JOIN Restaurants ON Orders.RestaurantID = Restaurants.RestaurantID
WHERE Orders.OrderStatus = 'Cancelled';
